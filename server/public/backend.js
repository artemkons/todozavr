(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=require("express");var n=e.n(t);const r=require("express-graphql"),o=require("mongoose");var a=e.n(o);const i=(0,require("graphql").buildSchema)("\n  type Todo {\n    id:ID!\n    title: String!\n    text: String!\n    done: Boolean!\n  }\n\n  type Query {\n    todo(id: ID!): Todo\n    allTodos: [Todo!]!\n  }\n\n  type Mutation {\n    addTodo(title: String!, text: String): Todo!\n    deleteTodo(id: ID!): [Todo]\n    editTodo(id: ID!, title: String!, text: String!): Todo!\n    doneTodo(id: ID!): Todo! \n  }\n"),u=require("@babel/runtime/helpers/asyncToGenerator");var s=e.n(u);const c=require("@babel/runtime/regenerator");var d=e.n(c),p=new o.Schema({title:String,text:String,done:{type:Boolean,default:!1}});const l=a().model("Todo",p);var f,v,x,h,y,g;const T={allTodos:(g=s()(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.find({});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)}),todo:(y=s()(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,l.findById(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)}),addTodo:(h=s()(d().mark((function e(t){var n,r,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,r=t.text,o=new l({title:n,text:r||""}),e.next=4,o.save();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)}),deleteTodo:(x=s()(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,l.findByIdAndDelete(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return x.apply(this,arguments)}),editTodo:(v=s()(d().mark((function e(t){var n,r,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.title,o=t.text,e.next=3,l.findByIdAndUpdate(n,{title:r,text:o},{new:!0});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)}),doneTodo:(f=s()(d().mark((function e(t){var n,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,l.findById(n);case 3:return(r=e.sent).done=!r.done,e.next=7,r.save();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})};a().connect("mongodb+srv://artemkons:123@cluster0.9mla7.mongodb.net/todos_db?retryWrites=true&w=majority",{useNewUrlParser:!0,useUnifiedTopology:!0,useFindAndModify:!1});var m=a().connection;m.on("error",(function(e){return console.log("Connection error ".concat(e))})),m.once("open",(function(){return console.log("Connected to DB!")}));var b=n()();b.use("/",n().static("client/public")),b.use("/api",(0,r.graphqlHTTP)({schema:i,rootValue:T,graphiql:!0})),b.listen(3e3,(function(){console.log("Example app listening at http://localhost")}))})();